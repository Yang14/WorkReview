##重构


###代码坏味道

* 重复代码：难以维护，修改时容易遗忘
* 过长函数：越长越难理解，函数最好是一眼能看懂，能增加复用的可能
* 过大的类：想做的事情太多权责很难单一
* 过长参数：>3个就该将参数封装成对象
* 过多注释：方法完成的任务过于复杂需要拆分；参数性说明可由参数校验工具替换



##代码规范

* 方法、类、包命名
	* 按驼峰命名法命名
	* 名字要和方法完成的任务一致，选择的单词最好是在业界应用广泛，做到顾名思
* 方法和类不能太大
	* 方法最好是只做一件事情
	* 类的权责要单一，只负责自身业务下的责任
* 不允许出现重复代码
* 入参和返回值
	* 外部系统传入的统一为DTO，返回值也应是DTO，并且实现序列化接口给定序列号
	* 返回给外部的DTO不能是内部使用的DO，否则模块耦合度增大、扩展性不好
	* 方法存在多种执行逻辑时，返回值应包含实际执行的逻辑结果
* 返回值
	* 与外部系统交互的返回值应该约定返回码
	* 封装所有可能的返回值，避免将抛异出给外部
* 异常处理：按场景决定向上级抛出或吞掉
	* 定义异常枚举类，包括错误码，并与业务方约定执行成功的返回码
	* 与外部系统交互时不应抛出异常：捕获异常并在返回结果注入异常码+描述信息
	* 通过切面拦截器捕获异常并做封装，这要注意使用拦截器的类的不可以同级调用
* 日志+报警：日志可记录信息、帮助定位错误
	* 按格式打出上下文描述信息和关键参数，便于分析
	* 明确需要打印的地方：操作类可打、查询类可不打，错误、异常必须打（异常栈深需要限制）
	* 明确日志输出的文件：错误、消息分开打还需一个打印所有信息的文件
	* 简化打日志代码方法：通过切面在需要输出日志的方法中打日志，让代码更简洁
* 报警：当业务流程已经无法正常运行的时候做必须报警，规范是：日志、报警、抛异常
 